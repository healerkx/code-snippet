<html>
	<head>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

	<script src="static/RC4.js" type="text/javascript"></script>
	
	<script type="text/javascript">

		function handleClick() {
			var form = $("[name='entry']");
			if (form.length > 0)
			{
				var name = form.find("[name='name']").val();
				var value = form.find("[name='value']").val();		
				var comment = form.find("[name='comment']").val();
				try
				{
					var nameEncoded = encodeURIComponent(name);
					var commentEncoded = encodeURIComponent(comment);
					
					
					encrypted = CryptoJS.RC4.encrypt(value, "RUSH10HITSRUSH10HITS");

					decrypted = CryptoJS.RC4.decrypt(encrypted.toString(), "RUSH10HITSRUSH10HITS");
					console.debug(decrypted.toString(CryptoJS.enc.Utf8));

				}
				catch(e)
				{
					console.debug(e);
					return false;
				}

				var entry = {'name': nameEncoded, 'value': "2", 'comment': commentEncoded};

				$.ajax({
			        url: '/add',
			        type: 'post',
			        data: entry,
			    }).done(function(data){
			    	console.debug(data);
			    });
			}

		    return false;
		}

	</script>
	</head>
	<body>
		<form name="entry" onSubmit="return handleClick()">
		 	<div>名称:<input type="text" name="name" /></div>
		 	<div>内容:<input type="text" name="value" /><div>
		  	<div>备注:<input type="text" name="comment" /><div>
		  	<input type="submit" value="添加" />
		</form>
	</body>
</html>
